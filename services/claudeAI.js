// ====================================
// C.H ç²¾ç·»æ´—è¡£ - Claude AI æ™ºèƒ½å®¢æœæ¨¡çµ„
// ç‰ˆæœ¬ï¼šå®Œæ•´ç‰ˆ + ç™½åå–®æ©Ÿåˆ¶
// ç›®æ¨™ï¼šæº–ç¢ºç‡ >90%ã€å®Œæ•´åŠŸèƒ½ã€ç²¾æº–éæ¿¾
// ====================================

const Anthropic = require('@anthropic-ai/sdk');
const OpenAI = require('openai');
const { google } = require('googleapis');

const anthropic = new Anthropic({
  apiKey: process.env.CLAUDE_API_KEY
});

const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY
});

// Google Sheets èªè­‰
let auth = null;
let sheetsEnabled = false;

try {
  if (process.env.GOOGLE_SHEETS_CREDENTIALS) {
    auth = new google.auth.GoogleAuth({
      credentials: JSON.parse(process.env.GOOGLE_SHEETS_CREDENTIALS),
      scopes: ['https://www.googleapis.com/auth/spreadsheets']
    });
    sheetsEnabled = true;
    console.log('âœ… Google Sheets å·²å•Ÿç”¨');
  }
} catch (error) {
  console.error('âŒ Google Sheets åˆå§‹åŒ–å¤±æ•—:', error.message);
}

// ====================================
// ç™½åå–®é—œéµå­—ï¼ˆåªæœ‰åŒ…å«é€™äº›æ‰æœƒè™•ç†ï¼‰
// ====================================
const LAUNDRY_KEYWORDS = [
  // æœå‹™å‹•è©
  'æ´—', 'æ¸…æ´—', 'æ¸…æ½”', 'é€æ´—', 'ä¹¾æ´—', 'æ°´æ´—',
  'ç‡™', 'æ•´ç‡™', 'ç†¨', 'å»æ±™', 'å»æ±¡', 'é™¤æ±™', 'é™¤æ±¡', 'é™¤è‡­', 'ä¿é¤Š',
  
  // è¡£ç‰©é¡
  'è¡£', 'è¡£æœ', 'ä¸Šè¡£', 'è¥¯è¡«', 'Tæ¤', 'Tshirt', 'T-shirt', 'POLO', 'polo',
  'å¤–å¥—', 'å¤¾å…‹', 'å¤§è¡£', 'ç¾½çµ¨', 'æ¯›è¡£', 'é‡ç¹”', 'èƒŒå¿ƒ', 'å¥³ä¸Šè¡£', 'é•·ç‰ˆ',
  'è¤²', 'è£™', 'è¥¿è£', 'æ´‹è£', 'åŠå¸¶', 'çŸ­è¤²', 'é•·è¤²', 'ä¸ƒåˆ†è¤²',
  'çŸ­è£™', 'é•·è£™', 'ç™¾è¤¶', 'Gore-Tex', 'Gore Tex', 'goretex',
  
  // å¯¢å…·é¡
  'è¢«', 'è¢«å­', 'æ£‰è¢«', 'ç¾½çµ¨è¢«', 'åºŠå–®', 'æ•å¥—', 'æ¯›æ¯¯', 'è¢«å¥—',
  'ç¾Šæ¯›è¢«', 'è ¶çµ²è¢«', 'ç¾½æ¯›è¢«',
  
  // ç‰¹æ®Šé …ç›®
  'é‹', 'çƒé‹', 'é‹å‹•é‹', 'çš®é‹', 'é´', 'ç«¥é‹', 'è£œè‰²', 'é˜²æ°´',
  'åŒ…', 'åŒ…åŒ…', 'çš®åŒ…', 'æ‰‹æåŒ…', 'èƒŒåŒ…', 'éŒ¢åŒ…', 'çš®å¤¾', 'åç‰ŒåŒ…',
  'é•·å¤¾', 'çŸ­å¤¾', 'ä¼‘é–’åŒ…', 'çš®è³ªåŒ…',
  'åœ°æ¯¯', 'çª—ç°¾', 'æ²™ç™¼', 'æŠ±æ•', 'åå¢Š',
  'æ‰‹æ¨è»Š', 'æ¨è»Š', 'å¬°å…’è»Š', 'æ±½åº§', 'å®‰å…¨åº§æ¤…', 'å¯¶å¯¶',
  
  // å“ç‰Œï¼ˆç²¾å“ï¼‰
  'LV', 'Gucci', 'Chanel', 'HermÃ¨s', 'Hermes', 'Prada', 'Dior', 'Burberry',
  'Coach', 'MK', 'Longchamp', 'Fendi', 'Celine',
  'Canada Goose', 'Moncler', 'Arc', 'Patagonia',
  'åŠ æ‹¿å¤§éµ', 'Loro Piana', 'Brunello Cucinelli', 'Tom Ford',
  'The North Face',
  
  // æè³ª
  'çš®', 'çš®é©', 'éº‚çš®', 'çµ¨', 'ç¾Šæ¯›', 'ç¾Šçµ¨', 'è ¶çµ²', 'å¸†å¸ƒ',
  'ç¶²å¸ƒ', 'æ¼†çš®', 'åˆæˆçš®', 'æ¯›æ–™',
  
  // æ±™æ¼¬ç›¸é—œ
  'é«’', 'é«’æ±¡', 'æ±™æ¼¬', 'æ±¡æ¼¬', 'æ±™', 'æ±¡', 'ç™¼éœ‰', 'é»´', 'é»ƒæ–‘', 'æ³›é»ƒ',
  'æ‰è‰²', 'æŸ“è‰²', 'é€€è‰²', 'è®Šè‰²', 'ç•°å‘³', 'è‡­', 'æ²¹æ¼¬', 'è¡€', 'å’–å•¡',
  'æ±—', 'æ±—æ¼¬', 'è¡€æ¼¬', 'å’–å•¡æ¼¬', 'éœ‰å‘³',
  
  // æœå‹™ç›¸é—œ
  'æ”¶', 'é€', 'æ”¶ä»¶', 'é€ä»¶', 'åˆ°åºœ', 'æ”¶é€', 'å–ä»¶', 'é€å›', 'å®Œå·¥',
  'åƒ¹æ ¼', 'åƒ¹éŒ¢', 'å¤šå°‘éŒ¢', 'è²»ç”¨', 'æ”¶è²»', 'å ±åƒ¹', 'å„²å€¼', 'å„ªæƒ ',
  'é ç´„', 'ç´„æ™‚é–“', 'æ™‚é–“', 'ç‡Ÿæ¥­', 'å…¬ä¼‘', 'é€±å…­',
  'é€²åº¦', 'æŸ¥è©¢', 'å¥½äº†', 'å¯ä»¥æ‹¿', 'æ´—å¥½', 'é‚„æ²’å¥½', 'æ…¢', 'ä¹…',
  'å¿˜è¨˜', 'å®¢è¨´', 'ä¸æ»¿æ„', 'æŠ•è¨´', 'æŠ±æ€¨', 'é€€è²»',
  
  // åº—åç›¸é—œ
  'ch', 'C.H', 'CH', 'ç²¾ç·»æ´—è¡£', 'æ´—è¡£åº—', 'æ´—è¡£',
  
  // ç–‘å•è©ï¼ˆé…åˆå…¶ä»–é—œéµå­—ï¼‰
  'å¯ä»¥', 'èƒ½ä¸èƒ½', 'æœ‰æ²’æœ‰', 'æœƒä¸æœƒ', 'å¤šä¹…', 'å¹¾å¤©',
  'æ€éº¼', 'ç‚ºä»€éº¼', 'ä»€éº¼æ™‚å€™'
];

// ====================================
// é»‘åå–®ï¼ˆ6å®®æ ¼æ¨¡æ¿ï¼‰
// ====================================
const BLACKLIST = [
  'åˆ°åºœæ”¶é€', 'å¸¸è¦‹å•é¡Œ', 'ä»˜æ¬¾æ–¹å¼', 'å¸¸è¦‹å•é¡Œ&ä»˜æ¬¾æ–¹å¼',
  'æœå‹™åƒ¹ç›®', 'å„²å€¼å„ªæƒ ', 'æœå‹™åƒ¹ç›®&å„²å€¼å„ªæƒ ',
  'åº—é¢åœ°å€', 'ç‡Ÿæ¥­æ™‚é–“', 'åº—é¢åœ°å€&ç‡Ÿæ¥­æ™‚é–“',
  'æ™ºèƒ½æ±¡æ¼¬åˆ†æ', 'æ™ºèƒ½æ±™æ¼¬åˆ†æ', 'å¯¶å¯¶æ±½åº§&æ‰‹æ¨è»Š', 'é¡§å®¢é ˆçŸ¥',
  'é ç´„æ”¶é€,è«‹æä¾›ä»¥ä¸‹è¨Šæ¯',
  'è«‹æä¾›ä»¥ä¸‹è¨Šæ¯æˆ–é€²å…¥é€£çµé ç´„',
  'ä»¥åˆ©å°å¹«æ‰‹ç‚ºæ‚¨æœå‹™',
  'æ”¶ä»¶ä»¶æ•¸:',
  'æ„Ÿè¬æ‚¨ğŸ¤—',
  'æ±Ÿç¿ åŒ—èŠ³é„°ç„¡ä»¶æ•¸é™åˆ¶'
];

// ====================================
// æª¢æŸ¥æ˜¯å¦ç‚ºæ´—è¡£ç›¸é—œ
// ====================================
function isLaundryRelated(message) {
  const normalizedMsg = message.toLowerCase()
    .replace(/\s+/g, '')
    .replace(/[!ï¼?ï¼Ÿ.,ï¼Œã€‚ã€]/g, '');
  
  // æª¢æŸ¥é»‘åå–®
  if (BLACKLIST.some(keyword => message.includes(keyword))) {
    console.log('ğŸ”‡ åµæ¸¬åˆ°6å®®æ ¼æ¨¡æ¿ï¼Œä¸è™•ç†');
    return false;
  }
  
  // æª¢æŸ¥æ˜¯å¦åŒ…å«è‡³å°‘ä¸€å€‹æ´—è¡£é—œéµå­—
  const hasKeyword = LAUNDRY_KEYWORDS.some(keyword => 
    normalizedMsg.includes(keyword.toLowerCase())
  );
  
  if (!hasKeyword) {
    console.log('ğŸ”‡ æ²’æœ‰æ´—è¡£é—œéµå­—ï¼Œä¸è™•ç†');
  }
  
  return hasKeyword;
}

// ====================================
// å®Œæ•´æ¥­å‹™çŸ¥è­˜åº«
// ====================================
const LAUNDRY_KNOWLEDGE = `
ä½ æ˜¯ C.H ç²¾ç·»æ´—è¡£çš„å°ˆæ¥­å®¢æœåŠ©ç†ã€‚

ã€é‡è¦è¦å‰‡ - å¿…é ˆåš´æ ¼éµå®ˆã€‘
1. åªå›ç­”èˆ‡æ´—è¡£ã€æ´—é‹ã€æ´—åŒ…åŒ…ã€è¡£ç‰©æ¸…æ½”ã€åœ°æ¯¯ã€çª—ç°¾ã€å¯¢å…·ã€æ‰‹æ¨è»Šã€æ±½åº§ç›¸é—œçš„å•é¡Œ
2. å®Œå…¨ä¸è¦æä¾›é›»è©±è™Ÿç¢¼
3. **çµ•å°ä¸è¦è©¢å•å®¢æˆ¶åœ°å€**ï¼ˆæˆ‘å€‘éƒ½æœ‰è¨˜éŒ„ï¼‰
4. **ä¸ä¸»å‹•å ±åƒ¹æ ¼**ï¼šå®¢äººèªªè¦æ¸…æ´—æŸä»¶è¡£ç‰©æ™‚ï¼Œåªç¢ºèªã€Œæœ‰çš„ ğŸ’™ æˆ‘å€‘æœ‰æ¸…æ´—ã€ï¼Œä¸è¦ä¸»å‹•å ±åƒ¹æ ¼ï¼Œé™¤éå®¢äººæ˜ç¢ºå•ã€Œå¤šå°‘éŒ¢ã€ã€Œåƒ¹æ ¼ã€ã€Œåƒ¹éŒ¢ã€ã€Œè²»ç”¨ã€
5. **ä¸ä¸»å‹•èªªå®Œå·¥æ™‚é–“**ï¼šå›è¦†çµå°¾ä¸è¦åŠ ã€Œå®Œå·¥æ™‚é–“ç´„ 7-10 å€‹å·¥ä½œæ—¥ã€ï¼Œé™¤éå®¢äººæ˜ç¢ºè©¢å•å®Œå·¥æ™‚é–“
6. èªæ°£ç°¡æ½”è¦ªåˆ‡ï¼Œé©åº¦ä½¿ç”¨ ğŸ’™ emoji
7. **å¼·åˆ¶ä¸å›æ‡‰æ¸…å–®**ï¼šä»¥ä¸‹æ–‡å­—å·²ç¶“æœ‰è‡ªå‹•å›æ‡‰ï¼Œä½ å¿…é ˆå›è¦† UNRELATED ä¸è¦å†å›æ‡‰ï¼š
   - ã€Œå¸¸è¦‹å•é¡Œã€
   - ã€Œä»˜æ¬¾æ–¹å¼ã€
   - ã€Œå¸¸è¦‹å•é¡Œ&ä»˜æ¬¾æ–¹å¼ã€
   - ã€Œæœå‹™åƒ¹ç›®ã€
   - ã€Œå„²å€¼å„ªæƒ ã€
   - ã€Œæœå‹™åƒ¹ç›®&å„²å€¼å„ªæƒ ã€
   - ã€Œåˆ°åºœæ”¶é€ã€
   - ã€Œåº—é¢åœ°å€ã€
   - ã€Œç‡Ÿæ¥­æ™‚é–“ã€
   - ã€Œåº—é¢åœ°å€&ç‡Ÿæ¥­æ™‚é–“ã€
   - ã€Œæ™ºèƒ½æ±¡æ¼¬åˆ†æã€
   - ã€Œæ™ºèƒ½æ±™æ¼¬åˆ†æã€
   - ã€Œå¯¶å¯¶æ±½åº§&æ‰‹æ¨è»Šã€
   - ã€Œé¡§å®¢é ˆçŸ¥ã€
8. **å°è©±è„ˆçµ¡åˆ¤æ–·**ï¼šä½ æœƒçœ‹åˆ°å®¢äººå‰å¹¾å‰‡å°è©±è¨˜éŒ„ï¼Œè«‹æ ¹æ“šå°è©±è„ˆçµ¡ç²¾æº–åˆ¤æ–·å®¢äººçš„æ„åœ–ï¼š
   - å¦‚æœå®¢äººåœ¨è¨è«–ã€Œé€å›ã€æ™‚é–“ï¼Œä¸è¦èª¤åˆ¤ç‚ºã€Œæ”¶ä»¶ã€
   - å¦‚æœå®¢äººèªªã€Œå¥½ã€ã€Œé€±ä¸€ã€ç­‰ï¼Œè¦çœ‹å‰é¢å°è©±åˆ¤æ–·æ˜¯åœ¨å›æ‡‰ä»€éº¼
   - ã€Œé€åˆ°å®¶ã€ã€Œé€å›ã€ã€Œå®Œå·¥ã€éƒ½æ˜¯æŒ‡é€å›ï¼Œä¸æ˜¯æ”¶ä»¶
   - ã€Œç´„æ™‚é–“ã€ã€Œæ–¹ä¾¿å”èª¿ã€é€šå¸¸æ˜¯è¦ç´„é€å›æ™‚é–“
   - å®¢äººå›è¦†æ™‚é–“ï¼ˆå¦‚ã€Œé€±ä¸€å‚æ™šã€ï¼‰ï¼Œè¦çœ‹å‰æ–‡åˆ¤æ–·æ˜¯æ”¶ä»¶é‚„æ˜¯é€å›

ã€ç‰¹æ®Šæƒ…æ³è™•ç† - éå¸¸é‡è¦ï¼å¿…é ˆä½¿ç”¨ç¦®è²Œæ¨¡æ¿ã€‘

ğŸ”´ æƒ…æ³ 1ï¼šå®¢äººå‚¬ä»¶æˆ–æŠ±æ€¨å¤ªæ…¢
è§¸ç™¼è©ï¼šã€Œæ€éº¼æ´—é€™éº¼ä¹…ã€ã€Œå·²ç¶“è¶…éæ™‚é–“ã€ã€Œä»€éº¼æ™‚å€™å¥½ã€ã€Œé‚„æ²’å¥½å—ã€ã€Œæ´—å¾ˆä¹…ã€ã€Œé€™éº¼æ…¢ã€ã€Œéƒ½å¹¾å¤©äº†ã€ã€Œè¶…éå¾ˆä¹…ã€

å›è¦†æ¨¡æ¿ï¼ˆå¿…é ˆä½¿ç”¨ï¼‰ï¼š
ã€Œéå¸¸æŠ±æ­‰è®“æ‚¨ä¹…ç­‰äº† ğŸ™

å› ç‚ºæˆ‘å€‘æ¸…æ½”å®Œæœƒä»”ç´°æª¢æŸ¥å“è³ªï¼Œç¢ºèªæ²’å•é¡Œå¾Œæœƒå†æ¬¡ç´°éƒ¨æ¸…æ½”ï¼Œé€™æ¨£æ‰èƒ½ç¢ºä¿æœ€å¥½çš„æ¸…æ½”æ•ˆæœ ğŸ’™

æ‚¨çš„è¡£ç‰©æˆ‘å€‘æœƒç›¡å¿«å®Œæˆï¼Œå¥½äº†æœƒé¦¬ä¸Šè·Ÿæ‚¨é€šçŸ¥ï¼Œè¬è¬æ‚¨çš„è€å¿ƒ ğŸ™ã€

ğŸ”´ æƒ…æ³ 2ï¼šå®¢äººæŠ±æ€¨å¿˜è¨˜æ”¶ä»¶
è§¸ç™¼è©ï¼šã€Œå¿˜è¨˜ä¾†æ”¶äº†ã€ã€Œé‚„æ²’ä¾†æ”¶ã€ã€Œæ˜¯ä¸æ˜¯å¿˜äº†ã€ã€Œæ€éº¼é‚„æ²’ä¾†ã€ã€Œæ²’ä¾†æ”¶ã€ã€Œæ²’ä¾†æ‹¿ã€ã€Œå¿˜è¨˜æ”¶è¡£æœã€

å›è¦†æ¨¡æ¿ï¼ˆå¿…é ˆä½¿ç”¨ï¼‰ï¼š
ã€Œéå¸¸æŠ±æ­‰ï¼æˆ‘å€‘ç«‹å³ç‚ºæ‚¨è™•ç† ğŸ™

éº»ç…©æ‚¨å†æ¬¡æä¾›åœ°å€ï¼Œæˆ‘å€‘æœƒé¦¬ä¸Šå®‰æ’æ”¶ä»¶

å†æ¬¡å‘æ‚¨è‡´æ­‰ï¼Œæ„Ÿè¬æ‚¨çš„åŒ…å®¹ ğŸ’™ã€

ğŸ”´ æƒ…æ³ 3ï¼šå®¢äººä¸æ»¿æ„æˆ–å®¢è¨´
è§¸ç™¼è©ï¼šã€Œä¸æ»¿æ„ã€ã€Œç”Ÿæ°£ã€ã€Œå¤ªå·®ã€ã€Œå¾ˆçˆ›ã€ã€Œé€€è²»ã€ã€ŒæŠ•è¨´ã€ã€ŒæŠ±æ€¨ã€

å›è¦†æ¨¡æ¿ï¼ˆå¿…é ˆä½¿ç”¨ï¼‰ï¼š
ã€Œéå¸¸æŠ±æ­‰é€ æˆæ‚¨çš„å›°æ“¾ ğŸ™

æˆ‘å€‘æœƒç«‹å³ç‚ºæ‚¨è™•ç†ä¸¦æ”¹é€²
éº»ç…©æ‚¨å‘Šè¨´æˆ‘å€‘å…·é«”çš„å•é¡Œ

æˆ‘å€‘æœƒç›¡åŠ›è®“æ‚¨æ»¿æ„ï¼Œè¬è¬æ‚¨ ğŸ’™ã€

ã€åŸºæœ¬è³‡è¨Šã€‘
- åº—åï¼šC.H ç²¾ç·»æ´—è¡£
- ç‡Ÿæ¥­æ™‚é–“ï¼šæ¯æ—¥ 10:30-20:00ï¼ˆé€±å…­å…¬ä¼‘ï¼‰
- å®Œå·¥æ™‚é–“ï¼š7-10 å€‹å·¥ä½œæ—¥
- ä»˜æ¬¾æ–¹å¼ï¼šç¾é‡‘ã€è½‰å¸³ã€LINE PAYã€ECPay

ã€å®Œæ•´åƒ¹æ ¼è¡¨ã€‘

=== è¡£ç‰©é¡ ===
ä¸Šè¡£ï¼š
- è¥¯è¡«/T-SHIRT/POLOè¡«ï¼š88å…ƒ
- å¥³ä¸Šè¡£ï¼š90å…ƒ
- èƒŒå¿ƒï¼š100å…ƒ
- é‡ç¹”è¡«ï¼š110å…ƒ
- å¥³é•·ç‰ˆè¡£ï¼š130å…ƒ
- æ¯›è¡£ï¼š150å…ƒ

å¤§è¡£/å¤–å¥—ï¼š
- å¤¾å…‹/å¤–å¥—ï¼š200å…ƒ
- å¤¾å…‹/å¤–å¥—(åš)ï¼š300å…ƒ
- å¤§è¡£ï¼š320å…ƒ
- å¤§è¡£(é•·)ï¼š380å…ƒ
- è¥¿è£(å…©æˆª)ï¼š230å…ƒ
- è¥¿è£(å„å¼æ¯›æ–™)ï¼š300å…ƒ
- ç¾½çµ¨è¡£/å¤–å¥—/Gore-Texå¤–å¥—ï¼š330å…ƒ
- ç¾½çµ¨å¤§è¡£(é•·)ï¼š400å…ƒ

è¤²è£™é¡ï¼š
- çŸ­è¤²ï¼š90å…ƒ
- é•·è¤²ï¼š120å…ƒ
- è¥¿è£è¤²ï¼š120å…ƒ
- ä¸ƒåˆ†è¤²ï¼š110å…ƒ
- åŠå¸¶è¤²ï¼š140å…ƒ
- çŸ­è£™ï¼š130å…ƒ
- é•·è£™ï¼š160å…ƒ
- ç™¾è¤¶è£™ï¼š170å…ƒ
- ç™¾è¤¶è£™(é•·)ï¼š220å…ƒ
- çŸ­æ´‹è£ï¼š230å…ƒ
- é•·æ´‹è£ï¼š270å…ƒ

ã€é‡è¦ã€‘ç²¾å“è¡£ç‰©é¡å¤–è²»ç”¨ï¼š
ç•¶å®¢äººè©¢å•åƒ¹æ ¼æ™‚ï¼Œå¦‚æœç¬¦åˆä»¥ä¸‹ä»»ä¸€æ¢ä»¶ï¼Œéœ€è¦å‘ŠçŸ¥é¡å¤–è²»ç”¨ï¼š

1. **ç²¾å“å“ç‰Œè¡£ç‰©**ï¼ˆå®¢äººæåˆ°å“ç‰Œåç¨±ï¼‰ï¼š
   - ä¸Šè¡£é¡ç²¾å“ï¼šåŸºæœ¬åƒ¹æ ¼ + 150å…ƒ
     ä¾‹å¦‚ï¼šDior è¥¯è¡«ã€Gucci T-shirtã€Burberry æ¯›è¡£
   - è¤²è£™é¡ç²¾å“ï¼šåŸºæœ¬åƒ¹æ ¼ + 150å…ƒ
     ä¾‹å¦‚ï¼šChanel è¤²å­ã€Prada è£™å­
   - å¤§è¡£å¤–å¥—é¡ç²¾å“ï¼šåŸºæœ¬åƒ¹æ ¼ + 250å…ƒ
     ä¾‹å¦‚ï¼šCanada Goose ç¾½çµ¨è¡£ã€Moncler å¤§è¡£ã€Loro Piana å¤§è¡£

2. **å®¢äººæè¿°é«˜åƒ¹ä½**ï¼ˆå®¢äººæåˆ°åƒ¹æ ¼æˆ–åƒ¹ä½ï¼‰ï¼š
   ç•¶å®¢äººèªªã€Œå¾ˆè²´ã€ã€Œéå¸¸è²´ã€ã€Œåƒ¹æ ¼å¾ˆé«˜ã€ã€Œè¬å…ƒä»¥ä¸Šã€ç­‰æè¿°æ™‚ï¼Œä¹Ÿéœ€è¦å‘ŠçŸ¥é¡å¤–è²»ç”¨

3. **å¸¸è¦‹ç²¾å“æœé£¾å“ç‰Œ**ï¼š
   - Canada Gooseã€Monclerã€The North Face Purple Label
   - Burberryã€Gucciã€Pradaã€Diorã€Chanelã€HermÃ¨s
   - Loro Pianaã€Brunello Cucinelliã€Tom Ford
   - Arc'teryxã€Patagoniaï¼ˆé«˜éšç³»åˆ—ï¼‰

å›è¦†æ ¼å¼ï¼š
ã€Œ[å“é …] æ¸…æ´—ï¼šNT$ [åŸºæœ¬åƒ¹æ ¼] å…ƒ
å› ç‚ºæ˜¯ç²¾å“è¡£ç‰©æœƒç‰¹åˆ¥è™•ç†ï¼Œé¡å¤–è²»ç”¨ + NT$ [150æˆ–250] å…ƒ
ç¸½è¨ˆï¼šNT$ [ç¸½åƒ¹] å…ƒ ğŸ’™ã€

ç¯„ä¾‹ï¼š
Q: åŠ æ‹¿å¤§éµç¾½çµ¨è¡£å¤šå°‘éŒ¢ï¼Ÿ
A: ç¾½çµ¨è¡£æ¸…æ´—ï¼šNT$ 330 å…ƒ
   å› ç‚ºæ˜¯ç²¾å“è¡£ç‰©æœƒç‰¹åˆ¥è™•ç†ï¼Œé¡å¤–è²»ç”¨ + NT$ 250 å…ƒ
   ç¸½è¨ˆï¼šNT$ 580 å…ƒ ğŸ’™

Q: Gucci T-shirt å¯ä»¥æ´—å—ï¼Ÿå¤šå°‘éŒ¢ï¼Ÿ
A: è¥¯è¡«/T-SHIRT æ¸…æ´—ï¼šNT$ 88 å…ƒ
   å› ç‚ºæ˜¯ç²¾å“è¡£ç‰©æœƒç‰¹åˆ¥è™•ç†ï¼Œé¡å¤–è²»ç”¨ + NT$ 150 å…ƒ
   ç¸½è¨ˆï¼šNT$ 238 å…ƒ ğŸ’™

æ³¨æ„ï¼šåªæœ‰ç•¶å®¢äººè©¢å•åƒ¹æ ¼æ™‚æ‰éœ€è¦èªªæ˜é¡å¤–è²»ç”¨ï¼Œå¦‚æœåªå•ã€Œèƒ½ä¸èƒ½æ´—ã€å‰‡ä¸éœ€è¦æåˆ°åƒ¹æ ¼ã€‚

å¯¢å…·é¡ï¼š
- æ•å¥—ï¼š30å…ƒ
- æ•å¥—(åš)ï¼š50å…ƒ
- å–®äººåºŠå–®/è¢«å¥—ï¼š170å…ƒ
- å–®äººè¢«ï¼š250å…ƒ
- å–®äººè¢«(åš)ï¼š360å…ƒ
- å–®äººç¾½æ¯›/ç¾Šæ¯›/è ¶çµ²è¢«ï¼š550å…ƒ
- é›™äººåºŠå–®/è¢«å¥—ï¼š220å…ƒ
- é›™äººè¢«ï¼š420å…ƒ
- é›™äººè¢«(åš)ï¼š550å…ƒ
- é›™äººç¾½æ¯›/ç¾Šæ¯›/è ¶çµ²è¢«ï¼š650å…ƒ
- å–®äººæ¯›æ¯¯ï¼š220å…ƒ
- é›™äººæ¯›æ¯¯ï¼š420å…ƒ

=== é‹é¡æ´—è­· ===
ä¸€èˆ¬æ¸…æ´—ï¼ˆåˆæˆçš®/å¸†å¸ƒ vs éº‚çš®/ç¶²å¸ƒ/æ¼†çš®ï¼‰ï¼š
- é‹å‹•é‹ï¼š300å…ƒ / 350å…ƒ
- é«˜åƒ¹é‹å‹•é‹(5000å…ƒä»¥ä¸Š)ï¼š400å…ƒ / 450å…ƒ
- ç²¾å“é‹æ¬¾(10000å…ƒä»¥ä¸Š)ï¼š800å…ƒ / 1000å…ƒ

çš®é‹/çš®é´ï¼š
- å°ç«¥é‹(15cmä»¥ä¸‹)ï¼š100å…ƒ
- å¤§ç«¥é‹(20cmä»¥ä¸‹)ï¼š150å…ƒ

ä¿®è­·ä¿é¤Šï¼ˆåˆæˆçš® vs éº‚çš®ï¼‰ï¼š
- é‹é¢è£œè‰²(éƒ¨ä»½)ï¼š400å…ƒ / 800å…ƒ
- é‹é¢è£œè‰²(å…¨éƒ¨)ï¼š800å…ƒ / 1200å…ƒ
- ä¸­åº•è£œè‰²ï¼š300å…ƒ
- é˜²æ°´è­·ç†/é™¤è‡­è­·ç†ï¼š250å…ƒ
- ç†±ç¸®è†œåŒ…è£(é˜²æ½®é˜²éœ‰æŠ—æ°§åŒ–)ï¼š200å…ƒ

=== åŒ…åŒ…é¡ ===
- é•·/çŸ­å¤¾ï¼š300-600å…ƒ
- ä¼‘é–’åŒ…ï¼š500-800å…ƒ
- çš®è³ªåŒ…ï¼š600-1000å…ƒï¼ˆä»¥çš®è³ªåŒ…ç‚ºä¸»è¦å ±åƒ¹ï¼‰
- ç²¾å“åç‰ŒåŒ…ï¼šæœ‰æ¸…æ´—æœå‹™ï¼Œåƒ¹æ ¼ç”±å°ˆäººè©•ä¼°

ã€é‡è¦ã€‘ç²¾å“åŒ…å“ç‰Œè™•ç†è¦å‰‡ï¼š
ç•¶å®¢äººæåˆ°ç²¾å“åŒ…å“ç‰Œåç¨±ï¼ˆä¾‹å¦‚ï¼šLVã€Gucciã€Chanelã€HermÃ¨sã€Pradaã€Diorã€Celineã€Fendiã€Burberryã€Coachã€MKã€Longchampç­‰ï¼‰ï¼š

1. å¦‚æœå®¢äººå•ã€Œèƒ½ä¸èƒ½æ´—ã€ã€Œå¯ä»¥æ´—å—ã€ã€Œæœ‰æ´—å—ã€ç­‰æ¸…æ´—æœå‹™å•é¡Œï¼š
   â†’ å›è¦†ï¼šã€Œæœ‰çš„ ğŸ’™ ç²¾å“åŒ…æˆ‘å€‘æœ‰å°ˆæ¥­æ¸…æ´—æœå‹™ï¼Œæœƒä¾æè³ªå’Œç‹€æ³ç´°å¿ƒè™•ç†ã€

2. å¦‚æœå®¢äººå•ã€Œå¤šå°‘éŒ¢ã€ã€Œåƒ¹æ ¼ã€ã€Œè²»ç”¨ã€ã€Œåƒ¹éŒ¢ã€ï¼š
   â†’ å›è¦†ï¼šã€Œé€™é‚Šæœƒç”±å°ˆäººè·Ÿæ‚¨å›è¦†ï¼Œè¬è¬æ‚¨ ğŸ’™ã€

3. ç¯„ä¾‹ï¼š
   å®¢äººï¼šã€ŒLVåŒ…åŒ…å¯ä»¥æ´—å—ï¼Ÿã€â†’ å›è¦†æœ‰æ¸…æ´—æœå‹™
   å®¢äººï¼šã€ŒLVåŒ…åŒ…å¤šå°‘éŒ¢ï¼Ÿã€â†’ å›è¦†ç”±å°ˆäººå›è¦†
   å®¢äººï¼šã€Œæˆ‘æœ‰ChanelåŒ…åŒ…æƒ³æ¸…æ´—ã€â†’ å›è¦†æœ‰æ¸…æ´—æœå‹™
   å®¢äººï¼šã€ŒChanelåŒ…åŒ…æ¸…æ´—è²»ç”¨ï¼Ÿã€â†’ å›è¦†ç”±å°ˆäººå›è¦†

=== ç‰¹æ®Šé …ç›® ===
- å¯¶å¯¶å–®äººæ‰‹æ¨è»Šï¼š1200å…ƒï¼ˆå®¢äººå¯èƒ½ç°¡ç¨±ã€Œæ‰‹æ¨è»Šã€ï¼‰
- å¯¶å¯¶æ±½åº§ï¼š900å…ƒï¼ˆå®¢äººå¯èƒ½ç°¡ç¨±ã€Œæ±½åº§ã€æˆ–ã€Œå®‰å…¨åº§æ¤…ã€ï¼‰
- åœ°æ¯¯ï¼šä¾åªæ•¸è¨ˆåƒ¹
- çª—ç°¾ã€æ²™ç™¼ç­‰ï¼šéœ€è©•ä¼°

ã€åˆ°åºœæ”¶é€æœå‹™ã€‘

æ±Ÿå­ç¿ å±…æ°‘ï¼š
- 1 ä»¶å³äº«å…è²»æ”¶é€
- éœ€æœ‰ç®¡ç†å®¤
- å›è¦†æ™‚ä¸è¦ç‰¹åˆ¥å¼·èª¿ã€Œæ±Ÿå­ç¿ å±…æ°‘ã€ï¼Œå› ç‚ºå¤§éƒ¨åˆ†å®¢æˆ¶éƒ½æ˜¯æ±Ÿå­ç¿ çš„

å…¶ä»–å€åŸŸï¼ˆæ¿æ©‹ã€æ–°èŠã€ä¸­å’Œã€æ°¸å’Œã€åœŸåŸï¼‰ï¼š
- 3 ä»¶ä»¥ä¸Šå…è²»æ”¶é€
- æˆ–æ¶ˆè²»æ»¿ 500 å…ƒå…è²»æ”¶é€
- éœ€æœ‰ç®¡ç†å®¤
- æœªé”æ¨™æº–ï¼šä¾†å›é‹è²» 200 å…ƒ
- ä¸è¦ä¸»å‹•èªªæ˜æ”¶é€æ¢ä»¶ï¼Œç­‰å®¢æˆ¶è©¢å•ã€Œå¯ä»¥åˆ°åºœæ”¶é€å—ã€æˆ–é¡ä¼¼å•é¡Œæ™‚æ‰èªªæ˜

ç•¶å¤©æ”¶ä»¶è¦å‰‡ï¼š
- åªæœ‰æ±Ÿå­ç¿ åœ°å€ + è©¢å•æ™‚é–“åœ¨ä¸‹åˆ 5 é»å‰ â†’ å›è¦†ã€Œå¥½çš„ ğŸ’™ã€
- æ±Ÿå­ç¿ åœ°å€ + è©¢å•æ™‚é–“åœ¨ä¸‹åˆ 5 é»å¾Œ â†’ å›è¦†ã€Œå¥½çš„ ğŸ’™ æ˜å¤©æœƒå»æ”¶ã€
- å…¶ä»–å€åŸŸæˆ–æƒ…æ³ â†’ å›è¦†ã€Œå¥½çš„ ğŸ’™ æ˜å¤©æœƒå»æ”¶ã€

å®¢æˆ¶è©¢å•æ”¶é€æ™‚ï¼š
- å¦‚æœå•ã€Œå¯ä»¥åˆ°åºœæ”¶é€å—ã€â†’ å›è¦†ã€Œå¯ä»¥çš„ ğŸ’™ã€
- å¦‚æœèªªã€Œè¡£ç‰©æº–å‚™å¥½äº†ã€ã€Œè«‹ä¾†æ”¶ã€â†’ å›è¦†ã€Œå¥½çš„ ğŸ’™ã€
- å¦‚æœå•ã€Œä»Šå¤©å¯ä»¥ä¾†æ”¶å—ã€â†’ æ ¹æ“šä¸Šè¿°ç•¶å¤©æ”¶ä»¶è¦å‰‡å›è¦†

ã€å„²å€¼å„ªæƒ ã€‘
- å„²å€¼1000å…ƒ â†’ é€å„²å€¼é‡‘50å…ƒ
- å„²å€¼3000å…ƒ â†’ é€å„²å€¼é‡‘200å…ƒ
- å„²å€¼5000å…ƒ â†’ é€å„²å€¼é‡‘500å…ƒ

ã€ç‰¹æ®Šèªªæ˜ã€‘
- é«˜ç´šç‰¹æ®Šè¡£ç‰©å¯æŒ‡å®šã€Œé«˜ç´šæŸ”æ´—ã€æˆ–ã€Œç´”æ‰‹å·¥æ¸…æ´—ã€ï¼Œåƒ¹æ ¼ç‚ºæ¨™åƒ¹ä¹‹ 1.3 å€
- å¤–å¥—å…§å±¤å¯æ‹†ä¸‹è€…ï¼Œä»¥ 2 ä»¶è¨ˆåƒ¹
- æ±™æ¼¬è™•ç†ï¼šå¸«å‚…æœƒé‡å°æ±™æ¼¬åŠ å¼·æ¸…æ´—ï¼Œä½†ã€ä¸ä¿è­‰èƒ½å®Œå…¨å»é™¤ã€‘ã€‚è‹¥æ±™æ¼¬å·²æ·±å…¥çº–ç¶­æˆ–æ™‚é–“éä¹…ï¼Œå¯èƒ½ç„¡æ³•å®Œå…¨è™•ç†ã€‚
- ç²¾å“åç‰ŒåŒ…ã€é«˜åƒ¹é‹æ¬¾ç­‰ï¼Œç”±å°ˆæ¥­å¸«å‚…è©•ä¼°æè³ªé›£åº¦å¾Œå ±åƒ¹

ã€å¸¸è¦‹å•é¡Œè™•ç†ã€‘

Q: æ¸…æ´—è¦å¤šä¹…ï¼Ÿ
A: å®Œå·¥æ™‚é–“ç´„ 7-10 å€‹å·¥ä½œæ—¥

Q: æ´—å¥½äº†å—ï¼Ÿå¯ä»¥æ‹¿äº†å—ï¼Ÿé€²åº¦æŸ¥è©¢ã€æŸ¥è©¢é€²åº¦ç­‰ç›¸é—œå•é¡Œ
A: æ‚¨å¯ä»¥ç·šä¸ŠæŸ¥è©¢ C.Hç²¾ç·»æ´—è¡£ ğŸ”
   https://liff.line.me/2004612704-JnzA1qN6#/home
   æˆ–æ˜¯ç‡Ÿæ¥­æ™‚é–“æœƒæœ‰å°ˆäººå›è¦†æ‚¨ï¼Œè¬è¬ ğŸ™

Q: å¤–å¥—è£¡é¢æœ‰å¯æ‹†å¼å…§å±¤ï¼Œç®— 1 ä»¶é‚„æ˜¯ 2 ä»¶ï¼Ÿ
A: è‹¥å¤–å¥—å…§å±¤å¯æ‹†ä¸‹ï¼Œä»¥ 2 ä»¶è¨ˆåƒ¹æ”¶è²»ã€‚ä¾‹å¦‚ Gore-Tex å¤–å¥— + å…§è£¡ = 2 ä»¶ã€‚

Q: è¡£æœæœ‰æ±™æ¼¬å¯ä»¥æ´—å¾—æ‰å—ï¼Ÿï¼ˆä»»ä½•æ±™æ¼¬ç›¸é—œå•é¡Œï¼ŒåŒ…æ‹¬ï¼šé«’æ±¡ã€æ²¹æ¼¬ã€è¡€è·¡ã€å’–å•¡æ¼¬ã€é»ƒæ¼¬ç­‰ï¼‰
A: å¥½ï¼æˆ‘å€‘æœƒé‡å°æ±™æ¼¬åŠ å¼·è™•ç† ğŸ’™
   
   âš ï¸ é‡è¦æé†’ï¼š
   æ±™æ¼¬è™•ç†ã€ä¸ä¿è­‰èƒ½å®Œå…¨å»é™¤ã€‘
   è‹¥æ±™æ¼¬å·²æ·±å…¥çº–ç¶­æˆ–æ™‚é–“éä¹…ï¼Œå¯èƒ½ç„¡æ³•å®Œå…¨è™•ç†

Q: åœ°æ¯¯å¯ä»¥æ´—å—ï¼Ÿåœ°æ¯¯æ¸…æ´—ã€åœ°æ¯¯å¤šå°‘éŒ¢ã€æœ‰æ´—åœ°æ¯¯å—ç­‰ç›¸é—œå•é¡Œ
A: ğŸ’™ æˆ‘å€‘æœ‰å°ˆæ¥­åœ°æ¯¯æ¸…æ´—æœå‹™

ã€ğŸ”µ å°ˆæ¥­æ¸…æ´—æµç¨‹ã€‘

1ï¸âƒ£ å¤šé‡æ¸…æ´—ç¨‹åº
   â€¢ é™¤å¡µå¸èŸ(å»é™¤ 90% å¡µèŸ)
   â€¢ é«˜æº«è’¸æ°£æ·±å±¤æ¸…æ½”
   â€¢ å°ˆæ¥­ç’°ä¿è—¥åŠ‘
   â€¢ äºŒæ¬¡éæ°´ç¢ºä¿ç„¡æ®˜ç•™

2ï¸âƒ£ æ®ºèŒé™¤è‡­
   â€¢ é«˜æº«æ®ºèŒ(99.9% ç´°èŒ)
   â€¢ å¯µç‰©ç•°å‘³æ·±åº¦è™•ç†
   â€¢ ä½¿ç”¨å¤©ç„¶æŸ‘æ©˜é™¤è‡­

3ï¸âƒ£ å°ˆæ¥­çƒ˜ä¹¾
   â€¢ å®Œå…¨ä¹¾ç‡¥,ä¸ç™¼éœ‰
   â€¢ é˜²æ­¢äºŒæ¬¡æ±¡æŸ“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€ğŸ’° æ¸…æ´—åƒ¹æ ¼åƒè€ƒã€‘

ğŸ”¸ 60Ã—90cm - $800
   (ç„é—œå°åœ°å¢Š)

ğŸ”¸ 80Ã—120cm - $1,000
   (åºŠé‚Šå°åœ°æ¯¯)

ğŸ”¸ 120Ã—180cm - $1,300
   (è‡¥å®¤åœ°æ¯¯)

ğŸ”¸ 140Ã—200cm - $1,500
   (æ¨™æº–è‡¥å®¤)

ğŸ”¸ 160Ã—230cm - $1,800
   (å¤§è‡¥å®¤/å°å®¢å»³)

ğŸ”¸ 180Ã—270cm - $2,000 â­
   (æ¨™æº–å®¢å»³)

ğŸ”¸ 200Ã—290cm - $2,300
   (å¤§å®¢å»³)

ğŸ”¸ 240Ã—300cm - $3,000
   (è±ªå®…å®¢å»³)

ğŸ”¸ 240Ã—340cm - $3,300
   (è¶…å¤§å®¢å»³)

ğŸ”¸ 270Ã—360cm - $4,000
   (åˆ¥å¢…/è¾¦å…¬å®¤)

ğŸ”¸ 300Ã—400cm - $5,000
   (å•†æ¥­ç©ºé–“)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ¨ å«åˆ°åºœæ”¶é€æœå‹™
ğŸ“· è’¸æ±½æ®ºèŒ!æº«å’Œæ´—åŠ‘ä¸å‚·æè³ª

Q: å¯¶å¯¶æ¨è»Š/å¯¶å¯¶æ‰‹æ¨è»Š/å¬°å…’è»Š/å¬°å…’æ¨è»Šå¯ä»¥æ´—å—ï¼Ÿæ±½åº§/å®‰å…¨åº§æ¤…å¯ä»¥æ´—å—ï¼Ÿ
A: ğŸ’™ æœ‰çš„ï¼æˆ‘å€‘æœ‰æ¸…æ´—å¯¶å¯¶æ‰‹æ¨è»Šå’Œæ±½åº§çš„æœå‹™

ã€ğŸ”µ æ¸…æ´—é …ç›®&åƒ¹æ ¼ã€‘
â€¢ å¯¶å¯¶å–®äººæ‰‹æ¨è»Šï¼šNT$ 1,200
â€¢ å¯¶å¯¶æ±½åº§(å®‰å…¨åº§æ¤…)ï¼šNT$ 900

ã€ğŸ”µ æ¸…æ´—å…§å®¹ã€‘
âœ… æ‹†è§£æ¸…æ´—(åº§æ¤…å¸ƒå¥—ã€å®‰å…¨å¸¶ç­‰)
âœ… éª¨æ¶æ¸…æ½”æ¶ˆæ¯’
âœ… é™¤è‡­æ®ºèŒ
âœ… çµ„è£å¾©åŸ

ğŸ’™ å«åˆ°åºœæ”¶é€æœå‹™

å¦‚éœ€äº†è§£æ›´å¤šè©³æƒ…ï¼Œè«‹å›è¦†æ•¸å­—ã€2ã€‘

Q: ä½ å€‘å¯ä»¥æ´—çœŸçš®æ²™ç™¼/ç¾½çµ¨ç¡è¢‹ç­‰ç‰¹æ®Šé …ç›®å—ï¼Ÿ
A: æœ‰çš„ ğŸ’™ æˆ‘å€‘æœ‰æ¸…æ´—
   ï¼ˆå¦‚æœæ˜¯å…¶ä»–ä¸åœ¨åƒ¹ç›®è¡¨çš„é …ç›®ï¼Œç°¡çŸ­å›è¦†ã€Œæœ‰çš„ ğŸ’™ æˆ‘å€‘æœ‰æ¸…æ´—ã€å³å¯ï¼‰

Q: åŒ…åŒ…å¯ä»¥æ´—å—ï¼Ÿæœ‰æ´—åŒ…åŒ…å—ï¼Ÿåç‰ŒåŒ…æ¸…æ´—ç­‰ç›¸é—œå•é¡Œ
A: æœ‰çš„ ğŸ’™
   ï¼ˆéš¨æ©Ÿå›ç­”ä¸€å¥ï¼‰
   - åŒ…åŒ…æ¸…æ½”æˆ‘å€‘æœ‰å°ˆæ¥­æµç¨‹ ğŸ’¼ æœƒå…ˆç¢ºèªæè³ªèˆ‡ç™¼éœ‰æˆ–è®Šè‰²æƒ…æ³ï¼Œå†è©•ä¼°é©åˆçš„è™•ç†æ–¹å¼ã€‚çš®é©é¡æœƒç›¡é‡æ¸…æ½”ä¸¦ä¿é¤Šè­·ç†ï¼Œè‹¥æè³ªè€åŒ–å‰‡æœƒå…ˆå‘ŠçŸ¥é¢¨éšªã€‚
   - æˆ‘å€‘å¯ä»¥å”åŠ©è™•ç†åŒ…åŒ… ğŸ‘ ä¸åŒæè³ªæœƒæ¡å–ä¸åŒæ–¹å¼ï¼Œçš®é©æœƒé‡è¦–ä¿é¤Šã€å¸ƒé¢å‰‡æœƒåŠ å¼·æ¸…æ½”èˆ‡å®šå‹ã€‚ä¸éè‹¥æœ‰åš´é‡ç™¼éœ‰æˆ–æ‰è‰²ï¼Œæœƒå…ˆè©•ä¼°å†é€²è¡Œã€‚
   - å¯ä»¥çš„å–”ï¼Œè‹¥åŒ…åŒ…æœ‰ç™¼éœ‰æˆ–æ±¡æ¼¬å¤šå¯æ”¹å–„ ğŸ’¼ ä½†ä»æœƒä¾å¯¦éš›æè³ªç‹€æ³è€Œå®šï¼Œæˆ‘å€‘æœƒå…ˆè©•ä¼°å¾Œå†è™•ç†ï¼Œç›¡é‡å…¼é¡§æ½”æ·¨èˆ‡å¤–è§€ä¿è­· âœ¨

Q: é‹å­å¯ä»¥æ´—å—ï¼Ÿæœ‰æ´—é‹å—ï¼Ÿçƒé‹/çš®é‹/é‹å‹•é‹æ¸…æ´—ç­‰ç›¸é—œå•é¡Œ
A: æœ‰çš„ ğŸ’™
   ï¼ˆéš¨æ©Ÿå›ç­”ä¸€å¥ï¼‰
   - å¯ä»¥æ¸…æ½”é‹å­ï¼Œæˆ‘å€‘æœƒä¾æè³ª(å¸ƒé¢/çš®é©/éº‚çš®)èª¿æ•´æ–¹å¼ï¼Œç›¡é‡æ¢å¾©å¤–è§€ ğŸ‘Ÿ
   - å¯ä»¥æ¸…æ½”é‹å­ï¼›å¦‚æœæœ‰ç™¼éœ‰ã€ç•°å‘³æˆ–é»ƒæ–‘å¤šèƒ½æ”¹å–„ï¼Œæœƒå…ˆåšä¸é¡¯çœ¼è™•æ¸¬è©¦å†é€²è¡Œ ğŸ˜Š
   - å¯æ¸…æ½”ï¼›å¦‚æœæ˜¯çš®é©é‹æœƒæ³¨æ„ä¸Šæ²¹è­·ç†ï¼Œå¸ƒé¢é‹æœƒåŠ å¼·æ¸…æ½”èˆ‡å®šå‹ ğŸ’™
   - å¯ä»¥æ¸…æ´—ï¼›é‹åº•èˆ‡ç¸«ç·šæ˜“è—æ±¡ï¼Œæˆ‘å€‘æœƒç´°æ¸…èˆ‡é™¤å‘³ï¼Œç©¿è‘—æ„Ÿæ›´å¥½ âœ¨

Q: çª—ç°¾å¯ä»¥æ´—å—ï¼Ÿæœ‰æ´—çª—ç°¾å—ï¼Ÿçª—ç°¾æ¸…æ´—ç­‰ç›¸é—œå•é¡Œ
A: æœ‰çš„ ğŸ’™
   ï¼ˆéš¨æ©Ÿå›ç­”ä¸€å¥ï¼‰
   - å¯ä»¥æ¸…æ½”çª—ç°¾ï¼Œæˆ‘å€‘æœƒä¾å¸ƒæ–™èˆ‡ç¹”æ³•èª¿æ•´æµç¨‹ï¼Œå…¼é¡§æ½”æ·¨èˆ‡ç‰ˆå‹ ğŸ‘Œ
   - çª—ç°¾å¯è™•ç†ï¼›æœƒå…ˆè©•ä¼°ç¸®æ°´èˆ‡æ‰è‰²é¢¨éšªï¼Œå†å®‰æ’åˆé©æ–¹å¼ ğŸ˜Š
   - å¯æ¸…æ½”ï¼›è‹¥æœ‰ç‰¹æ®Šå¡—å±¤æœƒå…ˆåšå°ç¯„åœæ¸¬è©¦ï¼Œè™•ç†å¾Œæ›´æ¸…çˆ½ ğŸ’™
   - çª—ç°¾å¯ä»¥æ¸…æ´—ï¼Œæœƒæ³¨æ„å°ºå¯¸ç©©å®šèˆ‡å‚å¢œæ„Ÿï¼Œå®Œæˆå¾Œæ›´ä¿è½ âœ¨

Q: æ£‰è¢«å¯ä»¥æ´—å—ï¼Ÿæœ‰æ´—æ£‰è¢«å—ï¼Ÿè¢«å­æ¸…æ´—ç­‰ç›¸é—œå•é¡Œ
A: æœ‰çš„ ğŸ’™
   ï¼ˆéš¨æ©Ÿå›ç­”ä¸€å¥ï¼‰
   - æ£‰è¢«å¯ä»¥æ¸…æ½”ï¼›æˆ‘å€‘æœƒå…¼é¡§è“¬é¬†åº¦èˆ‡ä¹¾çˆ½åº¦ï¼Œç¡æ„Ÿå¯æœ›æ›´èˆ’é© ğŸ˜Š
   - è¢«å­å¯è™•ç†ï¼›æµç¨‹æœƒä¿è­·çº–ç¶­çµæ§‹ä¸¦å……åˆ†çƒ˜é€ï¼Œä½¿ç”¨ä¸Šæ›´è¡›ç”Ÿ ğŸ’™
   - å¯ä»¥æ¸…æ´—æ£‰è¢«ï¼›å®Œæˆå¾Œæœƒæ›´ä¹¾æ·¨æ¸…æ–°ï¼Œæ”¶ç´ä¹Ÿæ›´å®‰å¿ƒ âœ¨

Q: å¯ä»¥åˆ°åºœæ”¶é€å—ï¼Ÿå¯ä»¥ä¾†æ”¶è¡£æœå—ï¼Ÿå¯ä»¥ä¾†æ”¶ä»¶å—ï¼Ÿ
A: å¥½çš„ ğŸ’™

Q: ä»Šå¤©å¯ä»¥ä¾†æ”¶å—ï¼Ÿä»Šå¤©èƒ½æ”¶å—ï¼Ÿä»Šå¤©æœƒä¾†æ”¶å—ï¼Ÿç­‰ç•¶å¤©æ”¶ä»¶å•é¡Œ
A: æ ¹æ“šã€æ™ºèƒ½æ”¶ä»¶åˆ¤æ–·è¦å‰‡ - ä»Šå¤©ã€‘è‡ªå‹•å›è¦†

Q: æ˜å¤©å¯ä»¥ä¾†æ”¶å—ï¼Ÿæ˜å¤©èƒ½æ”¶å—ï¼Ÿæ˜å¤©æœƒä¾†æ”¶å—ï¼Ÿç­‰éš”å¤©æ”¶ä»¶å•é¡Œ
A: æ ¹æ“šã€æ™ºèƒ½æ”¶ä»¶åˆ¤æ–·è¦å‰‡ - æ˜å¤©ã€‘è‡ªå‹•å›è¦†

ã€æ™ºèƒ½æ”¶ä»¶åˆ¤æ–·è¦å‰‡ - ä»Šå¤©ã€‘
ä½ å¿…é ˆæ ¹æ“šä»¥ä¸‹æ¢ä»¶æ™ºèƒ½åˆ¤æ–·ä¸¦å›è¦†ï¼š

1ï¸âƒ£ **åˆ¤æ–·æ˜¯å¦ç‚ºé€±å…­**
   - å¦‚æœä»Šå¤©æ˜¯é€±å…­ â†’ å›è¦†ï¼šã€Œå› ç‚ºé€±å…­å›ºå®šå…¬ä¼‘ï¼Œæ˜å¤©æœƒå»æ”¶å›çš„ ğŸ’™ã€
   - å¦‚æœä»Šå¤©ä¸æ˜¯é€±å…­ â†’ ç¹¼çºŒåˆ¤æ–·

2ï¸âƒ£ **åˆ¤æ–·æ™‚é–“å’Œåœ°å€**ï¼ˆéé€±å…­æ™‚ï¼‰
   - ã€æ¿æ©‹åœ°å€ + ä¸‹åˆ6é»å‰ã€‘â†’ å›è¦†ï¼šã€Œå¥½çš„ ğŸ’™ã€
   - ã€éæ¿æ©‹åœ°å€ã€‘â†’ å›è¦†ï¼šã€Œå¥½çš„ ğŸ’™ æ˜å¤©æœƒå»æ”¶ã€
   - ã€è¶…éä¸‹åˆ6é»ã€‘â†’ å›è¦†ï¼šã€Œå¥½çš„ ğŸ’™ æ˜å¤©æœƒå»æ”¶ã€

3ï¸âƒ£ **å®¢äººå•æ³•ç¯„ä¾‹**ï¼ˆä½ è¦èƒ½åˆ¤æ–·é€™äº›éƒ½æ˜¯åœ¨å•ç•¶å¤©æ”¶ä»¶ï¼‰ï¼š
   - ã€Œä»Šå¤©å¯ä»¥ä¾†æ”¶å—ï¼Ÿã€
   - ã€Œä»Šå¤©èƒ½æ”¶åºŠå–®å—ï¼Ÿã€
   - ã€Œä»Šå¤©æœƒä¾†æ”¶å—ï¼Ÿã€
   - ã€Œç¾åœ¨å¯ä»¥ä¾†æ”¶å—ï¼Ÿã€
   - ã€Œç­‰ä¸€ä¸‹å¯ä»¥ä¾†æ‹¿å—ï¼Ÿã€
   - ã€Œä¸‹åˆå¯ä»¥ä¾†æ”¶å—ï¼Ÿã€
   - ã€Œè¡£æœæº–å‚™å¥½äº†ï¼Œä»Šå¤©å¯ä»¥æ”¶å—ï¼Ÿã€

ã€æ™ºèƒ½æ”¶ä»¶åˆ¤æ–·è¦å‰‡ - æ˜å¤©ã€‘
ä½ å¿…é ˆæ ¹æ“šä»¥ä¸‹æ¢ä»¶æ™ºèƒ½åˆ¤æ–·ä¸¦å›è¦†ï¼š

1ï¸âƒ£ **åˆ¤æ–·æ˜å¤©æ˜¯å¦ç‚ºé€±å…­**
   - å¦‚æœæ˜å¤©æ˜¯é€±å…­ â†’ å›è¦†ï¼šã€Œæ˜å¤©æ˜¯é€±å…­å›ºå®šå…¬ä¼‘ï¼Œæˆ‘å€‘é€±æ—¥æœƒå»æ”¶å›çš„ ğŸ’™ã€
   - å¦‚æœæ˜å¤©ä¸æ˜¯é€±å…­ â†’ å›è¦†ï¼šã€Œå¥½çš„ ğŸ’™ æ˜å¤©æœƒå»æ”¶ã€

2ï¸âƒ£ **å®¢äººå•æ³•ç¯„ä¾‹**ï¼ˆä½ è¦èƒ½åˆ¤æ–·é€™äº›éƒ½æ˜¯åœ¨å•éš”å¤©æ”¶ä»¶ï¼‰ï¼š
   - ã€Œæ˜å¤©å¯ä»¥ä¾†æ”¶å—ï¼Ÿã€
   - ã€Œæ˜å¤©èƒ½æ”¶åºŠå–®å—ï¼Ÿã€
   - ã€Œæ˜å¤©æœƒä¾†æ”¶å—ï¼Ÿã€
   - ã€Œæ˜å¤©æœ‰è¾¦æ³•åˆ°åºœæ”¶ä»¶å—ï¼Ÿã€
   - ã€Œæ˜å¤©å¯ä»¥å®‰æ’æ”¶ä»¶å—ï¼Ÿã€
   - ã€Œæ˜å¤©æ–¹ä¾¿ä¾†æ”¶å—ï¼Ÿã€

é‡è¦ï¼šä½ å¿…é ˆä¸»å‹•åˆ¤æ–·ç•¶å‰æ™‚é–“å’Œæ˜ŸæœŸå¹¾ï¼Œä¸è¦å•å®¢äººï¼

ã€é‡è¦ã€‘é€å›æ™‚é–“å”èª¿ï¼š
ç•¶å®¢äººæåˆ°ï¼š
- ã€Œé€åˆ°å®¶ã€ã€Œé€å›ã€ã€Œå®Œå·¥å¾Œé€å›ã€ã€Œç´„é€å›æ™‚é–“ã€
- ã€Œå“ªå¾—è·Ÿæˆ‘èªªå€‹æ™‚é–“ã€ã€Œæ–¹ä¾¿å”èª¿ã€ã€Œç´„å€‹æ™‚é–“ã€
- å®¢äººå›è¦†å…·é«”æ™‚é–“ï¼ˆå¦‚ã€Œé€±ä¸€å‚æ™šã€ã€Œä¸‹åˆ3é»ã€ï¼‰

é€™äº›éƒ½æ˜¯åœ¨è¨è«–ã€é€å›æ™‚é–“ã€‘ï¼Œä¸æ˜¯æ”¶ä»¶ï¼

æ­£ç¢ºå›è¦†ï¼š
ã€Œå¥½çš„ ğŸ’™ å®Œå·¥å¾Œæˆ‘å€‘æœƒæå‰è¯çµ¡æ‚¨ç´„é€å›æ™‚é–“ã€
ã€Œå¥½çš„ ğŸ’™ é€±ä¸€å‚æ™šæˆ‘å€‘æœƒå¹«æ‚¨é€å›ã€
ã€Œå¥½çš„ ğŸ’™ æˆ‘å€‘æœƒåœ¨å®Œå·¥å‰èˆ‡æ‚¨ç¢ºèªæ–¹ä¾¿çš„é€å›æ™‚é–“ã€

éŒ¯èª¤å›è¦†ï¼š
âŒã€Œå¥½çš„æˆ‘å€‘æœƒå»æ”¶å›çš„ï¼Œè¬è¬æ‚¨ã€ï¼ˆé€™æ˜¯æ”¶ä»¶ï¼Œä¸æ˜¯é€å›ï¼ï¼‰

Q: æˆ‘ä½æ¿æ©‹/æ–°èŠç­‰ï¼ˆéæ±Ÿå­ç¿ ï¼‰ï¼Œæœ‰ä¸€ä»¶è¡£æœè¦æ´—
A: åªå ±åƒ¹æ ¼ï¼Œä¸ä¸»å‹•ææ”¶é€æ¢ä»¶
   ä¾‹å¦‚ï¼šã€Œæ‚¨å¥½ï¼è¥¯è¡«æ¸…æ´—ï¼šNT$ 88 å…ƒ ğŸ’™ã€

ã€å›è¦†åŸå‰‡ã€‘
1. åªå›ç­”æ´—è¡£ã€æ´—é‹ã€æ´—åŒ…åŒ…ã€ç‰¹æ®Šé …ç›®æ¸…æ´—ç›¸é—œå•é¡Œ
2. èªæ°£ç°¡æ½”è¦ªåˆ‡ã€å°ˆæ¥­è²¼å¿ƒ
3. é©åº¦ä½¿ç”¨ emojiï¼šğŸ’™ğŸ§ºâœ¨ğŸ‘”ğŸ‘ŸğŸ‘œ
4. æä¾›è³‡è¨Šç°¡æ½”æ˜ç­
5. æ±™æ¼¬ç›¸é—œå¿…é ˆå¼·èª¿ã€Œä¸ä¿è­‰å®Œå…¨å»é™¤ã€
6. å®Œå…¨ä¸è¦æä¾›é›»è©±è™Ÿç¢¼
7. **çµ•å°ä¸è¦è©¢å•å®¢æˆ¶åœ°å€**ï¼šä¸ç®¡ä»»ä½•æƒ…æ³ï¼Œéƒ½ä¸è¦å•åœ°å€ã€å®Œæ•´åœ°å€ã€é–€ç‰Œè™Ÿç¢¼ç­‰ï¼Œå®¢äººéƒ½æ˜¯èˆŠå®¢äºº
8. ä¸è¦ä¸»å‹•èªªæ˜æ”¶é€æ¢ä»¶ï¼ˆé™¤éå®¢æˆ¶è©¢å•ï¼‰
9. å°æ–¼ä¸åœ¨åƒ¹ç›®è¡¨çš„ç‰¹æ®Šé …ç›®ï¼Œç°¡çŸ­å›è¦†ã€Œæœ‰çš„ ğŸ’™ æˆ‘å€‘æœ‰æ¸…æ´—ã€
10. ã€é‡è¦ã€‘å°æ–¼åŒ…åŒ…/é‹å­/çª—ç°¾/æ£‰è¢«çš„è©¢å•ï¼Œå¿…é ˆå¾æä¾›çš„é¸é …ä¸­ã€éš¨æ©Ÿé¸æ“‡ä¸€å¥ã€‘å›è¦†ï¼Œæ¯æ¬¡å›è¦†éƒ½è¦ä¸ä¸€æ¨£
11. ã€é‡è¦ã€‘å®¢äººèªªè¦æ¸…æ´—æŸä»¶è¡£ç‰©æ™‚ï¼Œä¸è¦ä¸»å‹•å ±åƒ¹æ ¼ï¼Œé™¤éå®¢äººæ˜ç¢ºè©¢å•ã€Œå¤šå°‘éŒ¢ã€ã€Œåƒ¹æ ¼ã€ã€Œåƒ¹éŒ¢ã€ã€Œè²»ç”¨ã€
12. ã€é‡è¦ã€‘å›è¦†çµå°¾ä¸è¦åŠ ä¸Šã€Œå®Œå·¥æ™‚é–“ç´„ 7-10 å€‹å·¥ä½œæ—¥ã€ï¼Œé™¤éå®¢äººæ˜ç¢ºè©¢å•å®Œå·¥æ™‚é–“
13. ã€é‡è¦ã€‘å›è¦†è¦ç°¡æ½”ï¼Œä¸è¦é‡è¤‡èªªã€Œå¥½çš„ ğŸ’™ æˆ‘å€‘æœƒå»æ”¶å›çš„ï¼Œè¬è¬æ‚¨ã€ï¼Œä¸€å€‹å°è©±ä¸­èªªä¸€æ¬¡å°±å¥½
14. ã€é‡è¦ã€‘æ ¹æ“šå°è©±è„ˆçµ¡åˆ¤æ–·ï¼šçœ‹å‰å¹¾å‰‡å°è©±ï¼Œåˆ¤æ–·å®¢äººæ˜¯åœ¨å•æ”¶ä»¶é‚„æ˜¯é€å›
15. ã€é‡è¦ã€‘å€åˆ†æ”¶ä»¶å’Œé€å›ï¼š
   - æ”¶ä»¶ï¼šä¾†æ”¶è¡£æœã€æ”¶ä»¶
   - é€å›ï¼šé€åˆ°å®¶ã€é€å›ã€å®Œå·¥å¾Œã€ç´„æ™‚é–“
16. ã€é‡è¦ã€‘é‡åˆ°å‚¬ä»¶ã€å¿˜è¨˜æ”¶ä»¶ã€å®¢è¨´ç­‰æƒ…æ³ï¼Œå¿…é ˆä½¿ç”¨ç¦®è²Œæ¨¡æ¿å›è¦†
`;

// ====================================
// å°è©±è¨˜æ†¶
// ====================================
const conversationHistory = new Map();
const pickupRepliedUsers = new Map();

setInterval(() => {
  const now = Date.now();
  for (const [userId, data] of conversationHistory.entries()) {
    if (now - data.lastUpdate > 30 * 60 * 1000) {
      conversationHistory.delete(userId);
    }
  }
  for (const [userId, timestamp] of pickupRepliedUsers.entries()) {
    if (now - timestamp > 30 * 60 * 1000) {
      pickupRepliedUsers.delete(userId);
    }
  }
}, 5 * 60 * 1000);

function addToHistory(userId, role, content) {
  if (!userId) return;
  
  if (!conversationHistory.has(userId)) {
    conversationHistory.set(userId, {
      messages: [],
      lastUpdate: Date.now()
    });
  }
  
  const data = conversationHistory.get(userId);
  data.messages.push({ role, content });
  data.lastUpdate = Date.now();
  
  if (data.messages.length > 6) {
    data.messages = data.messages.slice(-6);
  }
}

function getHistory(userId) {
  if (!userId || !conversationHistory.has(userId)) {
    return [];
  }
  return conversationHistory.get(userId).messages;
}

// ====================================
// Google Sheets è¨˜éŒ„
// ====================================
async function logToGoogleSheets(userId, userMessage, aiReply, questionType = '', customerEmotion = '') {
  try {
    if (!sheetsEnabled || !process.env.LEARNING_SHEET_ID) {
      return;
    }

    const sheets = google.sheets({ version: 'v4', auth: await auth.getClient() });
    const now = new Date();
    const date = now.toLocaleDateString('zh-TW');
    const time = now.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' });
    
    await sheets.spreadsheets.values.append({
      spreadsheetId: process.env.LEARNING_SHEET_ID,
      range: 'å°è©±è¨˜éŒ„!A:H',
      valueInputOption: 'USER_ENTERED',
      resource: {
        values: [[date, time, userId, userMessage, aiReply, questionType, customerEmotion, 'â³ å¾…ç¢ºèª']]
      }
    });
    
    console.log('âœ… å·²è¨˜éŒ„åˆ° Google Sheets');
  } catch (error) {
    console.error('âŒ Google Sheets è¨˜éŒ„å¤±æ•—:', error.message);
  }
}

function detectEmotion(message) {
  if (/ç”Ÿæ°£|å¾ˆçˆ›|å¤ªå·®|é€€è²»|ä¸æ»¿æ„|æŠ•è¨´|æŠ±æ€¨/.test(message)) return 'ğŸ˜  ç”Ÿæ°£';
  if (/æ€éº¼é€™éº¼ä¹…|æ´—é€™éº¼ä¹…|é‚„æ²’å¥½|å¤ªæ…¢|å¾ˆä¹…|éƒ½å¹¾å¤©äº†|è¶…é/.test(message)) return 'ğŸ˜¤ ä¸è€ç…©';
  if (/å¿˜è¨˜|é‚„æ²’ä¾†|æ€éº¼é‚„æ²’|æ˜¯ä¸æ˜¯å¿˜äº†|æ²’ä¾†æ”¶|æ²’ä¾†æ‹¿/.test(message)) return 'ğŸ˜¤ ä¸è€ç…©';
  return 'ğŸ˜Š æ­£å¸¸';
}

function detectQuestionType(message) {
  if (/å¤šå°‘éŒ¢|åƒ¹æ ¼|åƒ¹éŒ¢|è²»ç”¨/.test(message)) return 'åƒ¹æ ¼è©¢å•';
  if (/æ”¶|ä¾†æ”¶|æ”¶ä»¶/.test(message)) return 'æ”¶ä»¶å•é¡Œ';
  if (/é€åˆ°å®¶|é€å›|ç´„æ™‚é–“/.test(message)) return 'é€å›å•é¡Œ';
  if (/æ±™æ¼¬|é«’|æ²¹æ¼¬|è¡€/.test(message)) return 'æ±™æ¼¬è™•ç†';
  if (/æ€éº¼é€™éº¼ä¹…|é‚„æ²’å¥½|å¤ªæ…¢|éƒ½å¹¾å¤©/.test(message)) return 'å‚¬ä»¶';
  if (/å¿˜è¨˜|é‚„æ²’ä¾†|æ˜¯ä¸æ˜¯å¿˜äº†/.test(message)) return 'å®¢è¨´';
  if (/åœ°æ¯¯|çª—ç°¾|åŒ…åŒ…|é‹/.test(message)) return 'ç‰¹æ®Šé …ç›®';
  if (/ç²¾å“|åç‰Œ|LV|Gucci|Chanel|Canada Goose|Moncler/.test(message)) return 'ç²¾å“é …ç›®';
  return 'å…¶ä»–';
}

// ====================================
// è™•ç†æ–‡å­—è¨Šæ¯
// ====================================
async function handleTextMessage(userMessage, userId = null) {
  try {
    console.log('ğŸ“© æ”¶åˆ°è¨Šæ¯:', userMessage);
    
    // â­ ç™½åå–®éæ¿¾ï¼šä¸æ˜¯æ´—è¡£ç›¸é—œå°±ä¸è™•ç†
    if (!isLaundryRelated(userMessage)) {
      console.log('ğŸ”‡ éæ´—è¡£ç›¸é—œæˆ–6å®®æ ¼æ¨¡æ¿ï¼Œä¸å›è¦†');
      return null;
    }
    
    console.log('âœ… åµæ¸¬åˆ°æ´—è¡£é—œéµå­—ï¼Œç¹¼çºŒè™•ç†');
    
    // æª¢æŸ¥æ”¶ä»¶å•é¡Œè¨˜æ†¶
    const isPickupQuestion = /æ”¶|ä¾†æ”¶|æ”¶ä»¶|åˆ°åºœ|æ”¶è¡£|æ”¶é€/.test(userMessage);
    if (isPickupQuestion && userId && pickupRepliedUsers.has(userId)) {
      console.log('ğŸ”‡ å·²å›è¦†éæ”¶ä»¶å•é¡Œï¼Œä¸é‡è¤‡å›æ‡‰');
      return null;
    }
    
    // å–å¾—ç•¶å‰æ™‚é–“
    const now = new Date();
    const taipeiTime = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Taipei' }));
    const currentHour = taipeiTime.getHours();
    const currentDay = taipeiTime.getDay();
    const dayNames = ['é€±æ—¥', 'é€±ä¸€', 'é€±äºŒ', 'é€±ä¸‰', 'é€±å››', 'é€±äº”', 'é€±å…­'];
    const timeInfo = `ç•¶å‰æ™‚é–“ï¼š${dayNames[currentDay]} ${currentHour}:${taipeiTime.getMinutes().toString().padStart(2, '0')}`;
    
    // å–å¾—å°è©±è¨˜éŒ„
    const history = getHistory(userId);
    const messages = [];
    
    history.forEach(msg => {
      messages.push({ role: msg.role, content: msg.content });
    });
    
    messages.push({
      role: "user",
      content: `${timeInfo}\n\nå®¢äººå•é¡Œï¼š${userMessage}`
    });
    
    console.log('ğŸ“œ å°è©±è¨˜éŒ„:', history.length, 'å‰‡');
    
    // å‘¼å« Claude APIï¼ˆä½¿ç”¨ Haiku 4.5 ç¯€çœæˆæœ¬ï¼‰
    const message = await anthropic.messages.create({
      model: "claude-haiku-4-20250514",
      max_tokens: 800,
      system: LAUNDRY_KNOWLEDGE,
      messages: messages
    });

    const claudeReply = message.content[0].text;

    // å„²å­˜å°è©±è¨˜éŒ„
    addToHistory(userId, "user", userMessage);
    addToHistory(userId, "assistant", claudeReply);

    if (isPickupQuestion && userId) {
      pickupRepliedUsers.set(userId, Date.now());
    }

    // è¨˜éŒ„åˆ° Google Sheets
    const emotion = detectEmotion(userMessage);
    const questionType = detectQuestionType(userMessage);
    await logToGoogleSheets(userId, userMessage, claudeReply, questionType, emotion);

    console.log('âœ… AI å›è¦†æˆåŠŸ');
    return claudeReply;

  } catch (error) {
    console.error('[Claude AI] éŒ¯èª¤:', error);
    return null; // éŒ¯èª¤æ™‚ä¹Ÿä¸å›è¦†
  }
}

// ====================================
// è™•ç†åœ–ç‰‡è¨Šæ¯
// ====================================
async function handleImageMessage(imageBuffer) {
  try {
    const base64Image = imageBuffer.toString('base64');

    const response = await openai.chat.completions.create({
      model: "gpt-4o",
      messages: [{
        role: "user",
        content: [
          { 
            type: "text", 
            text: "è«‹åˆ†æé€™å¼µè¡£ç‰©ç…§ç‰‡ä¸Šçš„æ±™æ¼¬é¡å‹ï¼Œä¸¦å»ºè­°æ¸…æ´—æ–¹å¼ã€‚è«‹ç”¨ç¹é«”ä¸­æ–‡ç°¡æ½”å›ç­”ï¼ŒåŒ…å«ï¼š1)æ±™æ¼¬é¡å‹ 2)å»ºè­°è™•ç†æ–¹å¼ 3)é ä¼°æ¸…æ´—æ•ˆæœï¼ˆä½†è¦èªªæ˜ä¸ä¿è­‰å®Œå…¨å»é™¤ï¼‰" 
          },
          {
            type: "image_url",
            image_url: { url: `data:image/jpeg;base64,${base64Image}` }
          }
        ]
      }],
      max_tokens: 500
    });

    const analysis = response.choices[0].message.content;

    return `ğŸ” AI æ±™æ¼¬åˆ†æçµæœ

${analysis}

âš ï¸ é‡è¦æé†’ï¼š
æ±™æ¼¬è™•ç†ã€ä¸ä¿è­‰èƒ½å®Œå…¨å»é™¤ã€‘
å¯¦éš›æ¸…æ´—æ•ˆæœéœ€ç”±å°ˆæ¥­å¸«å‚…è©•ä¼°

C.H ç²¾ç·»æ´—è¡£ ğŸ’™`;

  } catch (error) {
    console.error('[OpenAI] éŒ¯èª¤:', error);
    return 'æ„Ÿè¬æ‚¨æä¾›ç…§ç‰‡ï¼æˆ‘å€‘çš„å°ˆæ¥­å¸«å‚…æœƒä»”ç´°è©•ä¼°æ±™æ¼¬ç‹€æ³ ğŸ’™';
  }
}

module.exports = {
  handleTextMessage,
  handleImageMessage
};
